(function(e){function t(t){for(var n,o,r=t[0],l=t[1],c=t[2],u=0,d=[];u<r.length;u++)o=r[u],s[o]&&d.push(s[o][0]),s[o]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(e[n]=l[n]);p&&p(t);while(d.length)d.shift()();return i.push.apply(i,c||[]),a()}function a(){for(var e,t=0;t<i.length;t++){for(var a=i[t],n=!0,r=1;r<a.length;r++){var l=a[r];0!==s[l]&&(n=!1)}n&&(i.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},s={app:0},i=[];function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/";var r=window["webpackJsonp"]=window["webpackJsonp"]||[],l=r.push.bind(r);r.push=t,r=r.slice();for(var c=0;c<r.length;c++)t(r[c]);var p=l;i.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"106f":function(e,t,a){},4308:function(e,t,a){"use strict";var n=a("d9bc"),s=a.n(n);s.a},"56d7":function(e,t,a){"use strict";a.r(t);a("cadf"),a("551c");var n=a("2b0e"),s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("router-view")],1)},i=[],o=(a("5c0b"),a("2877")),r={},l=Object(o["a"])(r,s,i,!1,null,null,null),c=l.exports,p=a("8c4f"),u=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"home"},[a("v-app",[a("v-navigation-drawer",{attrs:{fixed:"",clipped:"",app:""},model:{value:e.drawer,callback:function(t){e.drawer=t},expression:"drawer"}},[a("v-expansion-panel",{staticClass:"v-selection-panel",model:{value:e.expand,callback:function(t){e.expand=t},expression:"expand"}},[a("v-expansion-panel-content",[a("div",{staticClass:"header ml-4",attrs:{slot:"header",title:"Click to close / open map layers"},slot:"header"},[e._v("Map Layers:")]),a("v-layer-control",{attrs:{layers:e.layers,map:e.map}})],1)],1),a("v-list",{attrs:{dense:""}},e._l(e.items,function(t){return a("v-list-tile",{key:t.text,on:{click:function(a){e.$router.push({name:t.route})}}},[a("v-list-tile-action",[a("v-icon",{attrs:{disabled:!t.public}},[e._v(e._s(t.icon))])],1),a("v-list-tile-content",[a("v-list-tile-title",{class:{"grey--text":!t.public}},[e._v("\n              "+e._s(t.text)+" "),t.public?e._e():a("v-icon",{attrs:{small:""}},[e._v("attach_money")])],1)],1)],1)}))],1),a("v-toolbar",{attrs:{dense:"",fixed:"","clipped-left":"",app:""}},[a("v-toolbar-side-icon",{on:{click:function(t){t.stopPropagation(),e.drawer=!e.drawer}}}),a("v-icon",{staticClass:"mx-3"},[e._v("fab fa-youtube")]),a("v-toolbar-title",{staticClass:"mr-5 align-center"},[a("span",{staticClass:"title"},[e._v("Sea-level and subsidence monitor")])]),a("v-spacer")],1),a("v-content",[a("v-container",{attrs:{fluid:"","fill-height":"","pa-0":""}},[a("v-layout",[a("v-flex",[a("v-mapbox",{ref:"map",attrs:{"access-token":"pk.eyJ1IjoiYWRyaWFhbnNlIiwiYSI6ImNqYXd4YnZ5dzc4dzMycW53b3lhMXZ6eDkifQ.bbG-PKhVspm-Mkh9zhO8hQ","map-style":"mapbox://styles/mapbox/satellite-streets-v10",id:"map"}},[a("v-map-layers")],1),a("div",{staticClass:"hidden"},[a("div",{ref:"popup",attrs:{id:"popup"}},[a("v-chart",{attrs:{options:e.chartOptions,"auto-resize":""}})],1)])],1)],1)],1)],1)],1)],1)},d=[],f=(a("a481"),a("7f7f"),a("6762"),a("2fdb"),a("7514"),a("ac6a"),new n["default"]),m=(a("bf40"),a("d1e7"),a("ac6d"),a("ce5b")),h=a.n(m),v=a("bd47"),g=a.n(v),y=a("e192"),b=a.n(y),x=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div")},_=[],k=[{id:"sshtrend",layerType:"gee",name:"SSH Trend",icon:"images/sshtrend.png",opacity:100,active:!0,info:'<i>source: <a href="https://podaac.jpl.nasa.gov/" target="_blank">NASA poodaac</a></i>',legend:{colors:["#151d44","#156c72","#7eb390","#fdf5f4","#db8d77","#9c3060","#340d35"],range:"-0.03 [m/year] +0.03"},serviceUrl:"http://hydro-engine.appspot.com/get_sea_surface_height_trend_image",data:[]},{id:"tidestations",layerType:"geojson",name:"Tide stations",icon:"images/marker-40.png",opacity:100,active:!0,info:'<i>source: <a href="http://www.psmsl.org" target="_blank">PSMSL</a></i>',data:[{id:"stations",type:"symbol",source:{type:"geojson",data:"https://storage.googleapis.com/slr/psmsl/locations.geojson"},layout:{"icon-image":"marker","icon-size":1.5}}]}],w={name:"v-map-layers",data:function(){return{map:null}},methods:{deferredMountedTo:function(e){k.forEach(function(t){f.$emit("add-layer",t),t.layerType&&(t.layerType.includes("mapbox")||t.layerType.includes("geojson"))&&t.data.forEach(function(a){a.active=t.active,a.opacity=t.opacity,e.addLayer(a)})})}}},C=w,O=(a("4308"),Object(o["a"])(C,x,_,!1,null,null,null)),S=O.exports,P=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("v-expansion-panel",{staticClass:"panel"},[a("draggable",{staticClass:"draggable",attrs:{options:{handle:".v-icon"}},on:{start:function(t){e.drag=!0},end:function(t){e.drag=!1}},model:{value:e.reverseLayers,callback:function(t){e.reverseLayers=t},expression:"reverseLayers"}},e._l(e.reverseLayers,function(t){return a("v-expansion-panel-content",{key:t.id,attrs:{focusable:""}},[a("div",{staticClass:"header",attrs:{slot:"header"},slot:"header"},[a("v-list",{attrs:{dense:""}},[a("v-list-tile",{attrs:{title:"Click to open / close layer properties"}},[a("v-icon",{staticClass:"draghandle mr-2",attrs:{title:"Drag to change map layer drawing order"},on:{click:function(e){e.stopPropagation()}}},[e._v("dehaze")]),a("v-list-tile-action",{on:{click:function(e){e.stopPropagation()}}},[a("v-switch",{attrs:{title:"Click to change layer visibility"},model:{value:t.active,callback:function(a){e.$set(t,"active",a)},expression:"layer.active"}})],1),a("v-list-tile-title",[e._v(e._s(t.name))]),t.icon?a("v-list-tile-avatar",{},[a("img",{attrs:{src:t.icon}})]):e._e()],1)],1)],1),a("div",{staticClass:"ma-0 pl-5 pr-5"},[t.opacity?a("v-slider",{attrs:{"hide-details":"",title:"Change layer opacity",min:1,max:100},model:{value:t.opacity,callback:function(a){e.$set(t,"opacity",a)},expression:"layer.opacity"}}):e._e(),t.id?e._t(t.id):e._e(),t.legend?a("div",[t.legend.colors&&t.legend.range?[t.legend.colors?a("div",{staticClass:"color-ramp mt-1",style:e.colorRamp(t.legend)}):e._e(),a("div",{staticClass:"range-ramp"},[e._v(e._s(t.legend.range))])]:e._e(),t.legend.colors&&t.legend.labels?e._l(t.legend.colors.length,function(n){return a("div",{key:n,staticClass:"color-label"},[a("span",{staticClass:"colored-span",style:"background-color: "+t.legend.colors[n-1]}),a("label",{staticClass:"ma-1"},[e._v(e._s(t.legend.labels[n-1]))])])}):e._e()],2):e._e(),t.info?a("div",{staticClass:"pb-2 pt-2",domProps:{innerHTML:e._s(t.info)}}):e._e()],2)])}))],1)},L=[],j=a("1516"),T=a.n(j),M={name:"layer-control",props:{layers:{type:Array,required:!0},map:{type:Object}},data:function(){return{expand:0,drag:!1}},computed:{reverseLayers:{get:function(){return this.layers.slice().reverse()},set:function(e){this.layers=e.slice().reverse()}}},watch:{layers:{handler:function(e){this.toggleLayers(),this.sortLayers(),f.$emit("select-layers",this.layers)},deep:!0}},mounted:function(){},methods:{sortLayers:function(){if(this.map&&this.layers){var e=this;this.layers.forEach(function(t){t.data.forEach(function(t){e.map.moveLayer(t.id)})})}},toggleLayers:function(){if(this.map&&this.layers){var e=this;this.layers.forEach(function(t){t.data.forEach(function(a){t.active?(e.map.setLayoutProperty(a.id,"visibility","visible"),e.setOpacity(a,t.opacity)):e.map.setLayoutProperty(a.id,"visibility","none")})})}},setOpacity:function(e,t){if(e&&t){var a=Math.max(.01*t,.01),n="".concat(e.type,"-opacity").replace("symbol","icon");this.map.setPaintProperty(e.id,n,a)}},colorRamp:function(e){if(e&&e.colors)return"background: linear-gradient(to right, "+e.colors.join()+");"}},components:{draggable:T.a}},D=M,$=(a("7857"),Object(o["a"])(D,P,L,!1,null,"68ce35dc",null)),A=$.exports,E=a("9ca8"),N=(a("ef97"),a("627c"),a("007d"),a("d28f"),a("cb8f"),a("0a6d"),{title:{text:"",subtext:"note: loading of nasa data takes +/- 30 sec",x:"center"},tooltip:{trigger:"axis",axisPointer:{animation:!1}},axisPointer:{link:{xAxisIndex:"all"}},legend:{data:["psmsl","nasa"],x:"left"},dataZoom:[{show:!0,realtime:!0,start:50,end:100,xAxisIndex:[0]},{type:"inside",realtime:!0,start:50,end:100,xAxisIndex:[0]}],xAxis:{type:"time"},yAxis:{type:"value"},series:[{name:"psmsl",data:[],type:"line"},{name:"nasa",data:[],type:"line"}]});n["default"].use(h.a),n["default"].use(g.a);var I="https://storage.googleapis.com/slr/psmsl/",z="http://hydro-engine.appspot.com/get_sea_surface_height_time_series",R={name:"home",data:function(){return{map:null,layers:[],drawer:!0,expand:0,popup:null,loading:0,psmslData:{},nasaData:{},chartOptions:N,items:[{icon:"trending_up",text:"Trends",public:!0,route:"trends"},{icon:"subscriptions",text:"Animations",public:!0,route:"animations"},{icon:"featured_play_list",text:"Reports",public:!1,route:"reports"},{icon:"alarm",text:"Signals",public:!1,route:"signals"},{icon:"business",text:"Cost estimates",public:!1,route:"cost"}]}},watch:{psmslData:function(e){var t=[];e.events.forEach(function(e){t.push([e.timeStamp.substring(0,10),e.value?e.value/1e3:null])}),this.chartOptions.series[0].data=t,console.log("PSMSL data: ".concat(e.events.length," months"))},nasaData:function(e){for(var t=[],a=0;a<e.times.length;a++)t.push([new Date(e.times[a]).toISOString().substring(0,10),e.values[a]]);this.chartOptions.series[1].data=t,console.log("NASA data: ".concat(e.times.length," months"))},loading:function(e){var t=e>0?"wait":"default";document.body.style.cursor=t,this.map.getCanvas().style.cursor=t,this.$refs.popup.style.cursor=t,(e<0||e>2)&&(this.loading=0)}},mounted:function(){var e=this;this.map=this.$refs.map.map,this.getMarker("marker"),f.$on("add-layer",function(t){e.layers.push(t),"gee"===t.layerType&&e.getGeeTileSet(t)}),this.map.on("mousemove",function(t){if(!e.loading){e.map.getCanvas().style.cursor="";var a=e.map.queryRenderedFeatures(t.point);if(a&&a.length>0){var n=a.find(function(e){return e.layer.id.includes("stations")});n&&(e.map.getCanvas().style.cursor="pointer")}}}),this.map.on("click",function(t){if(e.popup)e.popup.remove(),e.popup=null;else{e.chartOptions.series[0].data=[],e.chartOptions.series[1].data=[],e.chartOptions.title.text="",e.getNasaData(t.lngLat.lng,t.lngLat.lat);var a=e.map.queryRenderedFeatures(t.point);if(a&&a.length>0){var n=a.find(function(e){return e.layer.id.includes("stations")});e.chartOptions.title.text=n.properties.name,e.getPsmslData(n)}e.popupChart(t.lngLat)}})},methods:{getGeeTileSet:function(e){var t=this;fetch(e.serviceUrl).then(function(a){return a.json().then(function(a){var n={id:e.id,type:"raster",source:{type:"raster",tiles:[a.url],tileSize:256}};e.data=[n],t.map.addLayer(n)})})},getPsmslData:function(e){var t=this;if(e){this.loading++;var a=I+e.properties.rlr_monthly_url;fetch(a).then(function(e){return t.loading--,e.text()}).then(function(e){t.psmslData=JSON.parse(e.replace(/\bNaN\b/g,"null"))}).catch(function(e){console.log("Error loading PSMSL time series data: ".concat(e.message)),t.loading=0})}},getNasaData:function(e,t){var a=this;this.loading++;var n=JSON.stringify({region:{type:"Point",coordinates:[e,t]}});fetch(z,{method:"POST",body:n,mode:"cors",headers:{"Content-Type":"application/json"}}).then(function(e){return a.loading--,e.json()}).then(function(e){a.nasaData=e}).catch(function(e){console.log("Error loading NASA time series data: ".concat(e.message)),a.loading=0})},getMarker:function(e){var t=this;this.map.loadImage("images/".concat(e,".png"),function(a,n){if(a)throw a;t.map.addImage(e,n)})},popupChart:function(e){if(!this.popup){var t=this;this.popup=new b.a.Popup,this.popup.setDOMContent(this.$refs.popup),this.popup.setLngLat(e),this.popup.addTo(this.map),this.popup.on("close",function(e){t.popup=null})}}},components:{"v-map-layers":S,"v-layer-control":A,"v-chart":E["a"]}},J=R,q=(a("cccb"),Object(o["a"])(J,u,d,!1,null,null,null)),Y=q.exports;n["default"].use(p["a"]);var F=new p["a"]({routes:[{path:"/",name:"home",component:Y},{path:"/trends",name:"trends",component:Y},{path:"/animations",name:"animations",component:Y}]}),G=a("2f62");n["default"].use(G["a"]);var W=new G["a"].Store({state:{},mutations:{},actions:{}});n["default"].config.productionTip=!1,new n["default"]({router:F,store:W,render:function(e){return e(c)}}).$mount("#app")},"5c0b":function(e,t,a){"use strict";var n=a("106f"),s=a.n(n);s.a},7857:function(e,t,a){"use strict";var n=a("b0a3"),s=a.n(n);s.a},b0a3:function(e,t,a){},b861:function(e,t,a){},cccb:function(e,t,a){"use strict";var n=a("b861"),s=a.n(n);s.a},d9bc:function(e,t,a){}});
//# sourceMappingURL=app.b7c82643.js.map